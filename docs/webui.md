# Media Luna WebUI å‰ç«¯å¼€å‘æ–‡æ¡£

åŸºäº Koishi Console çš„ WebUI å‰ç«¯ï¼Œä½¿ç”¨ Vue 3 + TypeScriptã€‚

## æŠ€æœ¯æ ˆ

- Vue 3 Composition API
- TypeScript
- @koishijs/clientï¼ˆConsole å®¢æˆ·ç«¯åº“ï¼‰
- Element Plusï¼ˆå¯é€‰ï¼ŒKoishi Console è‡ªå¸¦åŸºç¡€ç»„ä»¶ï¼‰
- æ ·å¼å¿…é¡»èƒ½æ”¯æŒ Koishi è‡ªå¸¦çš„ä¸»é¢˜åˆ‡æ¢

## é¡µé¢ç»“æ„

```text
client/
â”œâ”€â”€ index.ts                 # å‰ç«¯å…¥å£
â”œâ”€â”€ components/              # å…¬å…±ç»„ä»¶
â”‚   â”œâ”€â”€ TagInput.vue         # æ ‡ç­¾è¾“å…¥ç»„ä»¶
â”‚   â”œâ”€â”€ JsonEditor.vue       # JSON ç¼–è¾‘å™¨
â”‚   â”œâ”€â”€ StatusBadge.vue      # çŠ¶æ€å¾½ç« 
â”‚   â””â”€â”€ ConfirmDialog.vue    # ç¡®è®¤å¯¹è¯æ¡†
â””â”€â”€ pages/
    â”œâ”€â”€ index.vue            # ç”Ÿæˆé¢æ¿ï¼ˆä¸»é¡µï¼‰
    â”œâ”€â”€ channels.vue         # æ¸ é“ç®¡ç†
    â”œâ”€â”€ presets.vue          # é¢„è®¾ç®¡ç†
    â”œâ”€â”€ tasks.vue            # ä»»åŠ¡ä¸­å¿ƒ
    â”œâ”€â”€ middlewares.vue      # ä¸­é—´ä»¶é…ç½®
    â””â”€â”€ settings.vue         # å…¨å±€è®¾ç½®
```

---

## é¡µé¢è¯¦ç»†éœ€æ±‚

### 1. ç”Ÿæˆé¢æ¿ (index.vue)

**åŠŸèƒ½**ï¼šåœ¨ WebUI ä¸­ç›´æ¥ç”Ÿæˆå›¾ç‰‡ã€‚

**UI å¸ƒå±€**ï¼š
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  æ¸ é“é€‰æ‹©: [ä¸‹æ‹‰æ¡†]        é¢„è®¾é€‰æ‹©: [ä¸‹æ‹‰æ¡†]             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚                    æç¤ºè¯è¾“å…¥                      â”‚  â”‚
â”‚  â”‚                   (textarea)                      â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  é™„ä»¶ä¸Šä¼ : [æ‹–æ‹½åŒºåŸŸ / ç‚¹å‡»ä¸Šä¼ ]                         â”‚
â”‚  å·²ä¸Šä¼ : [å›¾ç‰‡é¢„è§ˆ1] [å›¾ç‰‡é¢„è§ˆ2] [Ã—åˆ é™¤]                 â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  é«˜çº§å‚æ•°: [å±•å¼€/æ”¶èµ·]                                  â”‚
â”‚  â”œâ”€ å‚æ•°1: [è¾“å…¥æ¡†]                                    â”‚
â”‚  â””â”€ å‚æ•°2: [è¾“å…¥æ¡†]                                    â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚               [ é¢„è§ˆå‚æ•° ]    [ ç”Ÿæˆ ]                   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  ç”Ÿæˆç»“æœ:                                              â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”                               â”‚
â”‚  â”‚  å›¾ç‰‡1   â”‚ â”‚  å›¾ç‰‡2   â”‚                              â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                               â”‚
â”‚  è€—æ—¶: 3.2s  ä»»åŠ¡ID: 123                                â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**äº¤äº’é€»è¾‘**ï¼š
1. æ¸ é“é€‰æ‹©åï¼Œæ ¹æ®æ¸ é“æ ‡ç­¾ç­›é€‰å¯ç”¨é¢„è®¾ï¼ˆè°ƒç”¨ `presets/matching`ï¼‰
2. é€‰æ‹©é¢„è®¾åï¼Œé¢„è®¾çš„ `promptTemplate` æ˜¾ç¤ºåœ¨æç¤ºè¯åŒºåŸŸï¼ˆ`{{userText}}` é«˜äº®ï¼‰
3. ç‚¹å‡»"é¢„è§ˆå‚æ•°"è°ƒç”¨ `generate/preview`ï¼Œæ˜¾ç¤ºæœ€ç»ˆ prompt
4. ç‚¹å‡»"ç”Ÿæˆ"è°ƒç”¨ `generate`ï¼Œæ˜¾ç¤º loadingï¼Œå®Œæˆåå±•ç¤ºå›¾ç‰‡
5. ç”Ÿæˆå¤±è´¥æ—¶æ˜¾ç¤ºé”™è¯¯ä¿¡æ¯

**API è°ƒç”¨**ï¼š
- `media-luna/channels/list` - è·å–æ¸ é“åˆ—è¡¨
- `media-luna/presets/matching` - è·å–åŒ¹é…é¢„è®¾
- `media-luna/connectors/fields` - è·å–è¿æ¥å™¨å‚æ•°å®šä¹‰ï¼ˆç”¨äºé«˜çº§å‚æ•°ï¼‰
- `media-luna/generate/preview` - é¢„è§ˆ
- `media-luna/generate` - æ‰§è¡Œç”Ÿæˆ

---

### 2. æ¸ é“ç®¡ç† (channels.vue)

**åŠŸèƒ½**ï¼šCRUD æ¸ é“é…ç½®ã€‚

**UI å¸ƒå±€**ï¼š
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  [ + æ–°å»ºæ¸ é“ ]    æœç´¢: [______]    æ ‡ç­¾ç­›é€‰: [å¤šé€‰]     â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”â”‚
â”‚  â”‚ è¡¨æ ¼                                                â”‚â”‚
â”‚  â”‚ â”Œâ”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â” â”‚â”‚
â”‚  â”‚ â”‚å¯ç”¨â”‚  åç§°   â”‚  è¿æ¥å™¨   â”‚ æ ‡ç­¾ â”‚ åˆ›å»ºæ—¶é—´ â”‚ æ“ä½œ  â”‚ â”‚â”‚
â”‚  â”‚ â”œâ”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”¤ â”‚â”‚
â”‚  â”‚ â”‚ âœ“  â”‚ dalle3 â”‚ DALL-E   â”‚ img  â”‚ 12-01  â”‚ç¼–è¾‘|åˆ é™¤â”‚â”‚
â”‚  â”‚ â”‚ âœ—  â”‚ sd-xl  â”‚ Stable.. â”‚ img  â”‚ 12-02  â”‚ç¼–è¾‘|åˆ é™¤â”‚â”‚
â”‚  â”‚ â””â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**ç¼–è¾‘å¯¹è¯æ¡†**ï¼š
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  æ–°å»º/ç¼–è¾‘æ¸ é“                         [Ã—]  â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  åŸºæœ¬ä¿¡æ¯                                   â”‚
â”‚  â”œâ”€ åç§°*: [____________] (å”¯ä¸€æ ‡è¯†)        â”‚
â”‚  â”œâ”€ æ˜¾ç¤ºåç§°: [____________]                â”‚
â”‚  â”œâ”€ å¯ç”¨: [å¼€å…³]                            â”‚
â”‚  â””â”€ æ ‡ç­¾: [æ ‡ç­¾è¾“å…¥ç»„ä»¶]                    â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  è¿æ¥å™¨é…ç½®                                 â”‚
â”‚  â”œâ”€ è¿æ¥å™¨*: [ä¸‹æ‹‰é€‰æ‹©] â†’ åŠ¨æ€åŠ è½½å­—æ®µ      â”‚
â”‚  â”œâ”€ API URL*: [____________]                â”‚
â”‚  â”œâ”€ API Key*: [____________]                â”‚
â”‚  â””â”€ Model: [ä¸‹æ‹‰é€‰æ‹©]                       â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  ä¸­é—´ä»¶è¦†ç›– [å±•å¼€/æ”¶èµ·]                     â”‚
â”‚  â”œâ”€ è®¡è´¹: { ... }                          â”‚
â”‚  â””â”€ é¢„è®¾: { ... }                          â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                     [å–æ¶ˆ]  [ä¿å­˜]          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**äº¤äº’é€»è¾‘**ï¼š
1. è¡¨æ ¼æ”¯æŒå¿«é€Ÿåˆ‡æ¢å¯ç”¨çŠ¶æ€ï¼ˆè°ƒç”¨ `channels/toggle`ï¼‰
2. é€‰æ‹©è¿æ¥å™¨åï¼ŒåŠ¨æ€åŠ è½½è¯¥è¿æ¥å™¨çš„å­—æ®µå®šä¹‰ï¼ˆ`connectors/fields`ï¼‰
3. åˆ é™¤å‰å¼¹å‡ºç¡®è®¤å¯¹è¯æ¡†
4. è¡¨æ ¼æ”¯æŒæŒ‰æ ‡ç­¾ç­›é€‰

**API è°ƒç”¨**ï¼š
- `media-luna/channels/list`
- `media-luna/channels/create`
- `media-luna/channels/update`
- `media-luna/channels/delete`
- `media-luna/channels/toggle`
- `media-luna/channels/tags`
- `media-luna/connectors/list`
- `media-luna/connectors/fields`

---

### 3. é¢„è®¾ç®¡ç† (presets.vue)

**åŠŸèƒ½**ï¼šç®¡ç† prompt é¢„è®¾æ¨¡æ¿ã€‚

**UI å¸ƒå±€**ï¼š
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  [ + æ–°å»ºé¢„è®¾ ]    æ¥æº: [å…¨éƒ¨|ç”¨æˆ·|API]    æ ‡ç­¾: [å¤šé€‰] â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  å¡ç‰‡ç½‘æ ¼å¸ƒå±€                                           â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚  ğŸ¨ å†™å®é£æ ¼   â”‚  â”‚  âœ¨ åŠ¨æ¼«é£æ ¼  â”‚  â”‚  ğŸ–¼ æ²¹ç”»é£æ ¼  â”‚  â”‚
â”‚  â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚  â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚  â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚  â”‚
â”‚  â”‚  realistic.. â”‚  â”‚  anime sty.. â”‚  â”‚  oil paint.. â”‚  â”‚
â”‚  â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚  â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚  â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚  â”‚
â”‚  â”‚  [ç”¨æˆ·] [img] â”‚  â”‚  [API] [img] â”‚  â”‚  [ç”¨æˆ·] [art] â”‚  â”‚
â”‚  â”‚  [ç¼–è¾‘][å¤åˆ¶] â”‚  â”‚  [åªè¯»][å¤åˆ¶] â”‚  â”‚  [ç¼–è¾‘][åˆ é™¤] â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**ç¼–è¾‘å¯¹è¯æ¡†**ï¼š
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  æ–°å»º/ç¼–è¾‘é¢„è®¾                         [Ã—]  â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  åç§°*: [____________]                      â”‚
â”‚  æ˜¾ç¤ºåç§°: [____________]                   â”‚
â”‚  å¯ç”¨: [å¼€å…³]                               â”‚
â”‚  æ ‡ç­¾: [æ ‡ç­¾è¾“å…¥ç»„ä»¶]                       â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  æç¤ºè¯æ¨¡æ¿*:                               â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”â”‚
â”‚  â”‚ realistic photo, {{userText}}, high    â”‚â”‚
â”‚  â”‚ quality, 8k                             â”‚â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜â”‚
â”‚  æç¤º: ä½¿ç”¨ {{userText}} ä½œä¸ºç”¨æˆ·è¾“å…¥å ä½ç¬¦  â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  å‚è€ƒå›¾ç‰‡:                                  â”‚
â”‚  [æ‹–æ‹½ä¸Šä¼ åŒºåŸŸ]                             â”‚
â”‚  [å›¾ç‰‡1] [å›¾ç‰‡2] [Ã—]                        â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  å‚æ•°è¦†ç›– (JSON):                           â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”â”‚
â”‚  â”‚ { "steps": 30, "cfg_scale": 7 }        â”‚â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                     [å–æ¶ˆ]  [ä¿å­˜]          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**äº¤äº’é€»è¾‘**ï¼š
1. API æ¥æºçš„é¢„è®¾åªèƒ½æŸ¥çœ‹å’Œå¤åˆ¶ï¼Œä¸èƒ½ç¼–è¾‘/åˆ é™¤
2. å¤åˆ¶é¢„è®¾åè‡ªåŠ¨æ‰“å¼€ç¼–è¾‘å¯¹è¯æ¡†ï¼ˆæ¥æºæ”¹ä¸º userï¼‰
3. å¡ç‰‡æ˜¾ç¤ºé¢„è®¾çš„ promptTemplate é¢„è§ˆï¼ˆæˆªæ–­æ˜¾ç¤ºï¼‰
4. æ”¯æŒæŒ‰æ¥æºå’Œæ ‡ç­¾ç­›é€‰

**API è°ƒç”¨**ï¼š
- `media-luna/presets/list`
- `media-luna/presets/create`
- `media-luna/presets/update`
- `media-luna/presets/delete`
- `media-luna/presets/toggle`
- `media-luna/presets/copy`
- `media-luna/presets/tags`

---

### 4. ä»»åŠ¡ä¸­å¿ƒ (tasks.vue)

**åŠŸèƒ½**ï¼šæŸ¥çœ‹ç”Ÿæˆä»»åŠ¡å†å²å’Œç»Ÿè®¡ã€‚

**UI å¸ƒå±€**ï¼š
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  ç»Ÿè®¡æ¦‚è§ˆ                                               â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚  æ€»ä»»åŠ¡  â”‚  â”‚  æˆåŠŸ    â”‚  â”‚  å¤±è´¥    â”‚  â”‚ æˆåŠŸç‡   â”‚   â”‚
â”‚  â”‚  1234   â”‚  â”‚  1100   â”‚  â”‚  134    â”‚  â”‚ 89.1%   â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  ç­›é€‰: çŠ¶æ€[å…¨éƒ¨â–¼] æ¸ é“[å…¨éƒ¨â–¼]   [ æ¸…ç†æ—§ä»»åŠ¡ ]          â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  ä»»åŠ¡åˆ—è¡¨                                               â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”â”‚
â”‚  â”‚ #123 | dalle3 | "a cat..." | âœ“æˆåŠŸ | 3.2s | 12:30  â”‚â”‚
â”‚  â”‚ #122 | sd-xl  | "sunset.." | âœ—å¤±è´¥ | -    | 12:28  â”‚â”‚
â”‚  â”‚ #121 | dalle3 | "dog..."   | â—å¤„ç†ä¸­| -   | 12:25  â”‚â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  åˆ†é¡µ: [ä¸Šä¸€é¡µ] 1 2 3 ... [ä¸‹ä¸€é¡µ]   å…± 50 æ¡           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**ä»»åŠ¡è¯¦æƒ…å¯¹è¯æ¡†**ï¼š
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  ä»»åŠ¡è¯¦æƒ… #123                         [Ã—]  â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  çŠ¶æ€: âœ“ æˆåŠŸ                               â”‚
â”‚  æ¸ é“: dalle3                               â”‚
â”‚  è€—æ—¶: 3.2s                                 â”‚
â”‚  åˆ›å»ºæ—¶é—´: 2024-12-16 12:30:00              â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  åŸå§‹æç¤ºè¯:                                â”‚
â”‚  a cute cat playing with yarn               â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  æœ€ç»ˆæç¤ºè¯:                                â”‚
â”‚  realistic photo, a cute cat playing        â”‚
â”‚  with yarn, high quality, 8k                â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  ç”Ÿæˆç»“æœ:                                  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”                               â”‚
â”‚  â”‚  [å›¾ç‰‡]  â”‚                               â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                               â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  ä¸­é—´ä»¶æ—¥å¿—:                                â”‚
â”‚  billing: { charged: 100, currency: "ç‚¹æ•°" }â”‚
â”‚  preset: { name: "å†™å®", applied: true }   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                              [åˆ é™¤]  [å…³é—­] â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**äº¤äº’é€»è¾‘**ï¼š
1. ç‚¹å‡»ä»»åŠ¡è¡Œå±•å¼€è¯¦æƒ…
2. æ”¯æŒæŒ‰çŠ¶æ€ã€æ¸ é“ç­›é€‰
3. åˆ†é¡µåŠ è½½ï¼ˆé»˜è®¤ 50 æ¡/é¡µï¼‰
4. "æ¸…ç†æ—§ä»»åŠ¡"å¼¹å‡ºå¯¹è¯æ¡†é€‰æ‹©ä¿ç•™å¤©æ•°
5. å¤±è´¥ä»»åŠ¡æ˜¾ç¤ºé”™è¯¯ä¿¡æ¯

**API è°ƒç”¨**ï¼š
- `media-luna/tasks/list`
- `media-luna/tasks/get`
- `media-luna/tasks/delete`
- `media-luna/tasks/stats`
- `media-luna/tasks/cleanup`

---

### 5. ä¸­é—´ä»¶é…ç½® (middlewares.vue)

**åŠŸèƒ½**ï¼šæŸ¥çœ‹å’Œé…ç½®ä¸­é—´ä»¶ã€‚

**UI å¸ƒå±€**ï¼š
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  æ‰§è¡Œé¡ºåºé¢„è§ˆ                                           â”‚
â”‚  [prepare] â†’ [billing-pre] â†’ [preset] â†’ [request]      â”‚
â”‚           â†’ [billing-post] â†’ [task-recorder] â†’ [end]   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  ä¸­é—´ä»¶åˆ—è¡¨                                             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”â”‚
â”‚  â”‚ â˜‘ billing-pre     â”‚ é¢„æ‰£è´¹     â”‚ prepare  â”‚ [é…ç½®] â”‚â”‚
â”‚  â”‚ â˜‘ preset          â”‚ é¢„è®¾å¤„ç†   â”‚ pre-req  â”‚ [é…ç½®] â”‚â”‚
â”‚  â”‚ â˜‘ billing-post    â”‚ è®¡è´¹ç»“ç®—   â”‚ finalize â”‚ [é…ç½®] â”‚â”‚
â”‚  â”‚ â˜‘ task-recorder   â”‚ ä»»åŠ¡è®°å½•   â”‚ finalize â”‚ [é…ç½®] â”‚â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**é…ç½®å¯¹è¯æ¡†**ï¼š
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  é…ç½®: billing-pre (é¢„æ‰£è´¹)            [Ã—]  â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  å¯ç”¨: [å¼€å…³]                               â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  é…ç½®é¡¹ï¼ˆæ ¹æ® configSchema åŠ¨æ€æ¸²æŸ“ï¼‰:       â”‚
â”‚  â”œâ”€ mode: [pre â–¼]                          â”‚
â”‚  â”œâ”€ refundOnFail: [å¼€å…³]                   â”‚
â”‚  â””â”€ provider: [koishi-monetary â–¼]          â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚           [é‡ç½®é»˜è®¤]  [å–æ¶ˆ]  [ä¿å­˜]         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**äº¤äº’é€»è¾‘**ï¼š
1. æ‰§è¡Œé¡ºåºé¢„è§ˆå±•ç¤ºæ‹“æ‰‘æ’åºç»“æœ
2. å¯å¹¶è¡Œçš„ä¸­é—´ä»¶ç”¨åŒä¸€å±‚æ˜¾ç¤º
3. åˆ‡æ¢å¯ç”¨çŠ¶æ€ç«‹å³ç”Ÿæ•ˆ
4. é…ç½®è¡¨å•æ ¹æ® `configSchema` åŠ¨æ€ç”Ÿæˆ

**API è°ƒç”¨**ï¼š
- `media-luna/middlewares/list`
- `media-luna/middlewares/get`
- `media-luna/middlewares/update`
- `media-luna/middlewares/reset`
- `media-luna/middlewares/execution-order`

---

### 6. å…¨å±€è®¾ç½® (settings.vue)

**åŠŸèƒ½**ï¼šæ’ä»¶å…¨å±€é…ç½®ã€‚

**UI å¸ƒå±€**ï¼š
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  å…¨å±€è®¾ç½®                                               â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  è®¡è´¹é…ç½®                                               â”‚
â”‚  â”œâ”€ è®¡è´¹æ¨¡å¼: [é¢„æ‰£è´¹ â–¼]                               â”‚
â”‚  â”œâ”€ å¤±è´¥é€€æ¬¾: [å¼€å…³]                                   â”‚
â”‚  â””â”€ è´§å¸æä¾›è€…: [koishi-monetary â–¼]                    â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  ä»»åŠ¡è®¾ç½®                                               â”‚
â”‚  â”œâ”€ å¯ç”¨ä»»åŠ¡è®°å½•: [å¼€å…³]                               â”‚
â”‚  â”œâ”€ è‡ªåŠ¨æ¸…ç†: [å¼€å…³]                                   â”‚
â”‚  â””â”€ ä¿ç•™å¤©æ•°: [30]                                     â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  é¢„è®¾ API                                              â”‚
â”‚  â”œâ”€ å¯ç”¨è¿œç¨‹é¢„è®¾: [å¼€å…³]                               â”‚
â”‚  â”œâ”€ API URL: [____________]                            â”‚
â”‚  â””â”€ åˆ·æ–°é—´éš”: [3600] ç§’                                â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                      [ä¿å­˜è®¾ç½®]         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## å…¬å…±ç»„ä»¶

### TagInput.vue

æ ‡ç­¾è¾“å…¥ç»„ä»¶ï¼Œæ”¯æŒï¼š
- è¾“å…¥æ¡† + å›è½¦æ·»åŠ 
- æ ‡ç­¾æ˜¾ç¤º + åˆ é™¤æŒ‰é’®
- è‡ªåŠ¨è¡¥å…¨ï¼ˆåŸºäºå·²æœ‰æ ‡ç­¾ï¼‰

```vue
<TagInput v-model="tags" :suggestions="allTags" />
```

### StatusBadge.vue

çŠ¶æ€å¾½ç« ï¼Œæ ¹æ®çŠ¶æ€æ˜¾ç¤ºä¸åŒé¢œè‰²ï¼š
- `pending` - ç°è‰²
- `processing` - è“è‰²
- `success` - ç»¿è‰²
- `failed` - çº¢è‰²

```vue
<StatusBadge :status="task.status" />
```

### JsonEditor.vue

ç®€æ˜“ JSON ç¼–è¾‘å™¨ï¼š
- è¯­æ³•é«˜äº®
- æ ¼å¼åŒ–
- é”™è¯¯æç¤º

```vue
<JsonEditor v-model="config" :schema="configSchema" />
```

### ConfirmDialog.vue

ç¡®è®¤å¯¹è¯æ¡†ï¼š

```vue
<ConfirmDialog
  v-model:visible="showConfirm"
  title="ç¡®è®¤åˆ é™¤"
  content="åˆ é™¤åæ— æ³•æ¢å¤ï¼Œç¡®å®šè¦åˆ é™¤å—ï¼Ÿ"
  @confirm="handleDelete"
/>
```

---

## å…¥å£æ–‡ä»¶ (index.ts)

```typescript
import { Context } from '@koishijs/client'
import Index from './pages/index.vue'
import Channels from './pages/channels.vue'
import Presets from './pages/presets.vue'
import Tasks from './pages/tasks.vue'
import Middlewares from './pages/middlewares.vue'
import Settings from './pages/settings.vue'

export default (ctx: Context) => {
  ctx.page({
    name: 'ç”Ÿæˆ',
    path: '/media-luna',
    component: Index,
  })

  ctx.page({
    name: 'æ¸ é“',
    path: '/media-luna/channels',
    component: Channels,
  })

  ctx.page({
    name: 'é¢„è®¾',
    path: '/media-luna/presets',
    component: Presets,
  })

  ctx.page({
    name: 'ä»»åŠ¡',
    path: '/media-luna/tasks',
    component: Tasks,
  })

  ctx.page({
    name: 'ä¸­é—´ä»¶',
    path: '/media-luna/middlewares',
    component: Middlewares,
  })

  ctx.page({
    name: 'è®¾ç½®',
    path: '/media-luna/settings',
    component: Settings,
  })
}
```

---

## API è°ƒç”¨å°è£…

å»ºè®®åˆ›å»º `api.ts` å°è£…æ‰€æœ‰ API è°ƒç”¨ï¼š

```typescript
import { send } from '@koishijs/client'

// é€šç”¨å“åº”ç±»å‹
interface ApiResponse<T> {
  success: boolean
  data?: T
  error?: string
}

// å°è£…è°ƒç”¨
async function call<T>(event: string, params?: any): Promise<T> {
  const result = await send(event, params) as ApiResponse<T>
  if (!result.success) {
    throw new Error(result.error || 'è¯·æ±‚å¤±è´¥')
  }
  return result.data!
}

// æ¸ é“ API
export const channelApi = {
  list: () => call<ChannelConfig[]>('media-luna/channels/list'),
  get: (id: number) => call<ChannelConfig>('media-luna/channels/get', { id }),
  create: (data: Partial<ChannelConfig>) => call<ChannelConfig>('media-luna/channels/create', data),
  update: (id: number, data: Partial<ChannelConfig>) => call<ChannelConfig>('media-luna/channels/update', { id, data }),
  delete: (id: number) => call<void>('media-luna/channels/delete', { id }),
  toggle: (id: number, enabled: boolean) => call<void>('media-luna/channels/toggle', { id, enabled }),
  tags: () => call<string[]>('media-luna/channels/tags'),
}

// é¢„è®¾ API
export const presetApi = {
  list: (enabledOnly?: boolean) => call<PresetData[]>('media-luna/presets/list', { enabledOnly }),
  get: (id: number) => call<PresetData>('media-luna/presets/get', { id }),
  create: (data: Partial<PresetData>) => call<PresetData>('media-luna/presets/create', data),
  update: (id: number, data: Partial<PresetData>) => call<PresetData>('media-luna/presets/update', { id, data }),
  delete: (id: number) => call<void>('media-luna/presets/delete', { id }),
  toggle: (id: number, enabled: boolean) => call<void>('media-luna/presets/toggle', { id, enabled }),
  copy: (id: number) => call<PresetData>('media-luna/presets/copy', { id }),
  matching: (channelId: number) => call<PresetData[]>('media-luna/presets/matching', { channelId }),
}

// ä»»åŠ¡ API
export const taskApi = {
  list: (params?: TaskListParams) => call<TaskListResult>('media-luna/tasks/list', params),
  get: (id: number) => call<TaskData>('media-luna/tasks/get', { id }),
  delete: (id: number) => call<void>('media-luna/tasks/delete', { id }),
  stats: (channelId?: number) => call<TaskStats>('media-luna/tasks/stats', { channelId }),
  cleanup: (days?: number) => call<CleanupResult>('media-luna/tasks/cleanup', { days }),
}

// ä¸­é—´ä»¶ API
export const middlewareApi = {
  list: () => call<MiddlewareInfo[]>('media-luna/middlewares/list'),
  get: (name: string) => call<MiddlewareDetail>('media-luna/middlewares/get', { name }),
  update: (name: string, data: MiddlewareUpdateData) => call<void>('media-luna/middlewares/update', { name, data }),
  reset: (name: string) => call<void>('media-luna/middlewares/reset', { name }),
  executionOrder: () => call<ExecutionLevel[]>('media-luna/middlewares/execution-order'),
}

// è¿æ¥å™¨ API
export const connectorApi = {
  list: () => call<ConnectorInfo[]>('media-luna/connectors/list'),
  get: (id: string) => call<ConnectorDetail>('media-luna/connectors/get', { id }),
  fields: (id: string) => call<FieldDefinition[]>('media-luna/connectors/fields', { id }),
}

// ç”Ÿæˆ API
export const generateApi = {
  generate: (params: GenerateParams) => call<GenerationResult>('media-luna/generate', params),
  preview: (params: PreviewParams) => call<PreviewResult>('media-luna/generate/preview', params),
}
```

---

## æ³¨æ„äº‹é¡¹

1. **å“åº”å¼æ›´æ–°**ï¼šæ“ä½œå®Œæˆååˆ·æ–°åˆ—è¡¨æ•°æ®
2. **é”™è¯¯å¤„ç†**ï¼šç»Ÿä¸€ toast æç¤ºé”™è¯¯ä¿¡æ¯
3. **åŠ è½½çŠ¶æ€**ï¼šå¼‚æ­¥æ“ä½œæ˜¾ç¤º loading
4. **è¡¨å•éªŒè¯**ï¼šå¿…å¡«å­—æ®µã€æ ¼å¼æ ¡éªŒ
5. **ç¡®è®¤æ“ä½œ**ï¼šåˆ é™¤ç­‰å±é™©æ“ä½œéœ€äºŒæ¬¡ç¡®è®¤
6. **æƒé™æ§åˆ¶**ï¼šAPI æ¥æºé¢„è®¾ä¸å¯ç¼–è¾‘/åˆ é™¤ï¼ˆå‰ç«¯ç¦ç”¨æŒ‰é’®ï¼‰
